!function(e){"use strict";var i=function(e,t,n){var a,o,l=document.createElement("img");if(l.onerror=t,l.onload=function(){!o||n&&n.noRevoke||i.revokeObjectURL(o),t&&t(i.scale(l,n))},i.isInstanceOf("Blob",e)||i.isInstanceOf("File",e))a=o=i.createObjectURL(e),l._type=e.type;else{if("string"!=typeof e)return!1;a=e,n&&n.crossOrigin&&(l.crossOrigin=n.crossOrigin)}return a?(l.src=a,l):i.readFile(e,function(e){var i=e.target;i&&i.result?l.src=i.result:t&&t(e)})},t=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;i.isInstanceOf=function(e,i){return Object.prototype.toString.call(i)==="[object "+e+"]"},i.transformCoordinates=function(e,i){var t=e.getContext("2d"),n=e.width,a=e.height;switch(i>4&&(e.width=a,e.height=n),i){case 2:t.translate(n,0),t.scale(-1,1);break;case 3:t.translate(n,a),t.rotate(Math.PI);break;case 4:t.translate(0,a),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-a);break;case 7:t.rotate(.5*Math.PI),t.translate(n,-a),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-n,0)}},i.renderImageToCanvas=function(e,i,t,n,a,o,l,s,d,r){return e.getContext("2d").drawImage(i,t,n,a,o,l,s,d,r),e},i.scale=function(e,t){t=t||{};var n,a,o,l,s,d,r,c=document.createElement("canvas"),h=e.getContext||(t.canvas||t.crop||t.orientation)&&c.getContext,u=e.width,_=e.height,g=u,f=_,m=0,p=0,v=0,w=0;return h&&t.orientation>4?(n=t.maxHeight,a=t.maxWidth,o=t.minHeight,l=t.minWidth):(n=t.maxWidth,a=t.maxHeight,o=t.minWidth,l=t.minHeight),h&&n&&a&&t.crop?(s=n,d=a,n/a>u/_?(f=a*u/n,p=(_-f)/2):(g=n*_/a,m=(u-g)/2)):(s=u,d=_,r=Math.max((o||s)/s,(l||d)/d),r>1&&(s=Math.ceil(s*r),d=Math.ceil(d*r)),r=Math.min((n||s)/s,(a||d)/d),1>r&&(s=Math.ceil(s*r),d=Math.ceil(d*r))),h?(c.width=s,c.height=d,i.transformCoordinates(c,t.orientation),i.renderImageToCanvas(c,e,m,p,g,f,v,w,s,d)):(e.width=s,e.height=d,e)},i.createObjectURL=function(e){return t?t.createObjectURL(e):!1},i.revokeObjectURL=function(e){return t?t.revokeObjectURL(e):!1},i.readFile=function(e,i,t){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=i,t=t||"readAsDataURL",n[t])return n[t](e),n}return!1},"function"==typeof define&&define.amd?define(function(){return i}):e.loadImage=i}(this),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./load-image.js","jquery-ui"],e):e(window.jQuery,window.loadImage)}(function(e,i){"use strict";e.widget("blueimp.imagegallery",{options:{selector:'a[data-gallery="gallery"]',namespace:"imagegallery",slideshow:0,offsetWidth:100,offsetHeight:100,fullscreen:!1,canvas:!1,imageClickDivision:.5,bodyClass:"gallery-body",loaderId:"gallery-loader",effects:["blind","clip","drop","explode","fade","fold","puff","slide","scale"],modal:!0,resizable:!1,width:"auto",height:"auto",show:"fade",hide:"fade",dialogClass:"gallery-dialog"},_getOverlay:function(){return e(document.body).children(".ui-widget-overlay").last()},_openSibling:function(e){var i=this,t=this._dialog;clearTimeout(this._slideShow),this._slideShow=null,e.href!==this._link.href?t.dialog("widget").hide(this.options.hide,function(){i._overlay=i._getOverlay().clone().appendTo(document.body),t.dialog("option","hide",null).dialog("close"),i._callback=function(){i._overlay.remove(),i._overlay=null},i._open(e)}):t.dialog("close")},_prev:function(){this._openSibling(this._prevLink)},_next:function(){this._openSibling(this._nextLink)},_keyHandler:function(e){var i=e.data.imagegallery;switch(e.which){case 37:case 38:return i._prev(),!1;case 39:case 40:return i._next(),!1}},_wheelHandler:function(e){var i=e.data.imagegallery;return e=e.originalEvent,i._wheelCounter+=e.wheelDelta||e.detail||0,e.wheelDelta&&i._wheelCounter>=120||!e.wheelDelta&&i._wheelCounter<0?(i._prev(),i._wheelCounter=0):(e.wheelDelta&&i._wheelCounter<=-120||!e.wheelDelta&&i._wheelCounter>0)&&(i._next(),i._wheelCounter=0),!1},_clickHandler:function(e){var i=e.data.imagegallery,t=i._dialog;(e.pageX-t.offset().left)/t.width()<i.options.imageClickDivision?i._prev():i._next()},_overlayClickHandler:function(i){var t=i.data.imagegallery;e(this).unbind("click."+t.options.namespace,t._overlayClickHandler),t._dialog.dialog("close")},_openHandler:function(i){var t=i.data.imagegallery,n=t.options;e(document.body).addClass(n.bodyClass),t._getOverlay().bind("click."+n.namespace,i.data,t._overlayClickHandler),t._callback&&(t._callback(),t._callback=null),n.slideshow&&(t._slideShow=setTimeout(function(){t._next()},n.slideshow))},_closeHandler:function(i){var t=i.data.imagegallery,n=t.options;e(document).unbind("keydown."+n.namespace,t._keyHandler).unbind("mousewheel."+n.namespace+", DOMMouseScroll."+n.namespace,t._wheelHandler),clearTimeout(t._slideShow),t._slideShow=null,t._overlay||(e(document.body).removeClass(n.bodyClass),t._position=null),t._dialog.remove(),t._dialog=null},_dragStopHandler:function(e,i){var t=e.data.imagegallery;t._position=i.position},_initDialogHandlers:function(){var i=this,t=this.options,n={imagegallery:this};e(document).bind("keydown."+t.namespace,n,this._keyHandler).bind("mousewheel."+t.namespace+", DOMMouseScroll."+t.namespace,n,this._wheelHandler),i._dialog.bind("click."+t.namespace,n,this._clickHandler).bind("dialogopen."+t.namespace,n,this._openHandler).bind("dialogclose."+t.namespace,n,this._closeHandler).bind("dialogdragstop."+t.namespace,n,this._dragStopHandler)},_loadHandler:function(i){var t=this.options;t.offsetWidth,t.offsetHeight,this._dialog=e("<div></div>"),this._loaded=!0,e(document).unbind("keydown."+t.namespace,this._escapeHandler).unbind("click."+t.namespace,this._documentClickHandler),this._img=null,this._loadingAnimation.hide(),this._initDialogHandlers(),this._position&&(t=e.extend({},t,{position:[this._position.left,this._position.top]})),this._dialog.append(i).appendTo(document.body).toggleClass("gallery-dialog-single",this._prevLink===this._link&&this._nextLink===this._link).dialog(t)},_abortLoading:function(){var i=this.options;this._img.unbind(),e(document).unbind("keydown."+i.namespace,this._escapeHandler).unbind("click."+i.namespace,this._documentClickHandler),this._getOverlay().remove(),this._loadingAnimation.hide(),e(document.body).removeClass(i.bodyClass)},_escapeHandler:function(e){27===e.keyCode&&e.data.imagegallery._abortLoading()},_documentClickHandler:function(i){var t=i.data.imagegallery;e(i.target).closest(t._link).length||t._abortLoading()},_loadImage:function(){var t,n=this,a=this.options,o={imagegallery:this},l=e(window).width(),s=e(window).height();t=a.fullscreen?{minWidth:l,minHeight:s,maxWidth:l,maxHeight:s,canvas:a.canvas}:{maxWidth:l-a.offsetWidth,maxHeight:s-a.offsetHeight,canvas:a.canvas},e(document).bind("keydown."+a.namespace,o,this._escapeHandler).bind("click."+a.namespace,o,this._documentClickHandler),n._loaded=null,this._img=e(i(this._link.href,function(e){n._loadHandler(e)},t)),setTimeout(function(){n._loaded||n._loadingAnimation.show()},100)},_preloadSiblings:function(){e("<img>").prop("src",this._nextLink.href),e("<img>").prop("src",this._prevLink.href)},_initSiblings:function(){var e=this,i=this._link,t=this.element.find(this.options.selector);this._prevLink=null,this._nextLink=null,t.each(function(n){return t[n+1]!==i&&t[n+2]!==i||this.href===i.href||(e._prevLink=this),t[n-1]!==i&&t[n-2]!==i||this.href===i.href?void 0:(e._nextLink=this,!1)}),this._prevLink||(this._prevLink=t[t.length-1]),this._nextLink||(this._nextLink=t[0])},_getRandomEffect:function(){var e=this.options.effects;return e[Math.floor(Math.random()*e.length)]},_initEffects:function(){var e=this.options;("random"===e.show||"random"===this._show)&&(this._show="random",e.show=this._getRandomEffect()),("random"===e.hide||"random"===this._hide)&&(this._hide="random",e.hide=this._getRandomEffect())},_open:function(i){if(this._dialog){var t=e.extend({},this);return t._dialog=null,t._position=null,t._open(i),void 0}this.options.title=i.title||decodeURIComponent(i.href.split("/").pop()),this._link=i,this._initEffects(),this._loadImage(),this._initSiblings(),this._preloadSiblings()},_initFullscreenOptions:function(){var e=this.options;e.fullscreen?(/-fullscreen$/.test(e.dialogClass)||(e.dialogClass+="-fullscreen"),/-fullscreen$/.test(e.bodyClass)||(e.bodyClass+="-fullscreen")):(e.dialogClass=e.dialogClass.replace(/-fullscreen$/,""),e.bodyClass=e.bodyClass.replace(/-fullscreen$/,""))},_initLoadingAnimation:function(){this._loadingAnimation=e('<div id="'+this.options.loaderId+'"></div>').hide().appendTo(document.body)},_destroyLoadingAnimation:function(){this._loadingAnimation.remove(),this._loadingAnimation=null},_delegate:function(){var e=this,i=this.options;this.element.delegate(i.selector,"click."+i.namespace,function(i){i.preventDefault(),e._open(this)})},_undelegate:function(){this.element.undelegate(this.options.selector,"click."+this.options.namespace)},_setOption:function(i,t){this._show=this._hide=null;var n="namespace"===i||"selector"===i;n&&this._undelegate(),e.Widget.prototype._setOption.call(this,i,t),n&&this._delegate(),-1!==e.inArray(i,["fullscreen","dialogClass","bodyClass"])&&this._initFullscreenOptions()},_create:function(){this._wheelCounter=0,this._initLoadingAnimation(),this._initFullscreenOptions(),this._delegate()},destroy:function(){clearTimeout(this._slideShow),this._slideShow=null,this._dialog&&this._dialog.dialog("close"),this._undelegate(),this._destroyLoadingAnimation(),e.Widget.prototype.destroy.call(this)},enable:function(){e.Widget.prototype.enable.call(this),this._delegate()},disable:function(){clearTimeout(this._slideShow),this._slideShow=null,this._undelegate(),e.Widget.prototype.disable.call(this)}})});